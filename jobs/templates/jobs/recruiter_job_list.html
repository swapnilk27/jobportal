{% extends "base.html" %}

{% block title %}Recruiter's Job List{% endblock %}

{% block navbar_buttons %}
<div class="d-flex">
    <a class="btn btn-light border-0 shadow-sm mr-2"
       href="{% url 'post_job' %}">
        Post Job
    </a>

    <a class="btn btn-light border-0 shadow-sm mr-2"
       href="{% url 'recruiter_dashboard' %}">
        Dashboard
    </a>
</div>
{% endblock %}


{% block page_header %}
<div class="container mt-4">
    <h2 class="fw-semibold">Job List</h2>
    <p class="text-muted">All jobs posted by you</p>

    <form method="GET" class="mb-4">
        <div class="input-group shadow-sm">
            <input type="text"
                   name="q"
                   value="{{ query }}"
                   class="form-control border-0"
                   placeholder="Search by job title or location">
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="submit">
                    Search
                </button>
            </div>
        </div>
    </form>

    <hr>
</div>
{% endblock %}


{% block content %}
<div class="container mt-4">

    {% if recruiter_job_list_page_obj %}

    <div class="list-group shadow-sm rounded">

        {% for job in recruiter_job_list_page_obj %}
        <div class="list-group-item py-3">

            <div class="d-flex justify-content-between align-items-center">

                <div>
                    <h5 class="mb-1 fw-semibold">
                        {{ job.job_title }}
                    </h5>

                    {% if job.status == "open" %}
                    <span class="badge badge-success">Open</span>
                    {% else %}
                    <span class="badge badge-secondary">Closed</span>
                    {% endif %}

                    <small class="text-muted d-block mt-1">
                        <strong>{{ job.company_name }}</strong> |
                        {{ job.location }} |
                        {{ job.created_date|date:"d M Y" }}
                    </small>
                </div>

                <div class="d-flex">
                    <a href="{% url 'job_applications' job.id %}"
                       class="btn btn-sm btn-outline-secondary mr-2">
                        Applications
                    </a>

                    <a href="{% url 'edit_job' job.id %}"
                       class="btn btn-sm btn-outline-warning mr-2">
                        Edit
                    </a>

                    <a href="{% url 'toggle_job_status' job.id %}"
                       class="btn btn-sm {% if job.status == 'open' %}btn-outline-danger{% else %}btn-outline-success{% endif %}">
                        {% if job.status == "open" %}Close{% else %}Reopen{% endif %}
                    </a>
                </div>

            </div>

        </div>
        {% endfor %}

    </div>

    {% else %}
    <div class="card shadow-sm p-4 text-center">
        <h5 class="mb-0 text-muted">
            You haven't posted any jobs yet.
        </h5>
    </div>
    {% endif %}

</div>  <!-- end container -->

{% if recruiter_job_list_page_obj %}
<nav>
    <ul class="pagination justify-content-center mt-4">

        {% if recruiter_job_list_page_obj.has_previous %}
        <li class="page-item">
            {% if query %}
            <a class="page-link"
               href="?q={{ query }}&page={{ recruiter_job_list_page_obj.previous_page_number }}">
                Previous
            </a>
            {% else %}
            <a class="page-link"
               href="?page={{ recruiter_job_list_page_obj.previous_page_number }}">
                Previous
            </a>
            {% endif %}
        </li>
        {% endif %}

        <li class="page-item active">
            <span class="page-link">
                Page {{ recruiter_job_list_page_obj.number }}
                of {{ recruiter_job_list_page_obj.paginator.num_pages }}
            </span>
        </li>

        {% if recruiter_job_list_page_obj.has_next %}
        <li class="page-item">
            {% if query %}
            <a class="page-link"
               href="?q={{ query }}&page={{ recruiter_job_list_page_obj.next_page_number }}">
                Next
            </a>
            {% else %}
            <a class="page-link"
               href="?page={{ recruiter_job_list_page_obj.next_page_number }}">
                Next
            </a>
            {% endif %}
        </li>
        {% endif %}

    </ul>
</nav>
{% endif %}

{% endblock %}
